{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8701,"status":"ok","timestamp":1660375497218,"user":{"displayName":"이우원","userId":"05495556713808915653"},"user_tz":-540},"id":"r-q6KMwWtQWa","outputId":"0052898c-aeda-46ab-bc44-534ba269ddea"},"outputs":[{"name":"stdout","output_type":"stream","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting tensorflow_addons\n","  Downloading tensorflow_addons-0.17.1-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.1 MB)\n","\u001b[K     |████████████████████████████████| 1.1 MB 12.3 MB/s \n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from tensorflow_addons) (21.3)\n","Requirement already satisfied: typeguard>=2.7 in /usr/local/lib/python3.7/dist-packages (from tensorflow_addons) (2.7.1)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->tensorflow_addons) (3.0.9)\n","Installing collected packages: tensorflow-addons\n","Successfully installed tensorflow-addons-0.17.1\n"]}],"source":["!pip install tensorflow_addons"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":30145,"status":"ok","timestamp":1660375527355,"user":{"displayName":"이우원","userId":"05495556713808915653"},"user_tz":-540},"id":"KJCN058SLgyp","outputId":"5ef62a3e-ef96-485d-87fb-1d7938a33bd8"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive\n"]}],"source":["import os\n","import cv2\n","import numpy as np\n","from glob import glob\n","from scipy.io import loadmat\n","import matplotlib.pyplot as plt\n","\n","import tensorflow as tf\n","from tensorflow import keras\n","from tensorflow.keras import layers\n","\n","from google.colab import drive\n","drive.mount('/content/drive')\n","\n","import os\n","os.chdir('/content/drive/MyDrive/Colab Notebooks/collage/segmentation')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ETU20GzMODpD"},"outputs":[],"source":["DATA_DIR = \"/content/drive/MyDrive/Colab Notebooks/collage/segmentation/data/rawdata/\"\n","\n","all_images = sorted(glob(os.path.join(DATA_DIR, \"humanparsing/val/Images/*\"))+glob(os.path.join(DATA_DIR, \"humanparsing/train/Images/*\"))+glob(os.path.join(DATA_DIR, \"fashion/JPEGImages/*\")))\n","all_masks = sorted(glob(os.path.join(DATA_DIR, \"humanparsing/val/Human/*\"))+glob(os.path.join(DATA_DIR, \"humanparsing/train/Human/*\"))+glob(os.path.join(DATA_DIR, \"fashion/SegmentationClassAug/*\")))\n","\n","from sklearn.model_selection import train_test_split\n","val_size = 5000\n","train_images, val_images, train_masks, val_masks  = train_test_split(all_images, all_masks, test_size=val_size)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1582,"status":"ok","timestamp":1660377805895,"user":{"displayName":"이우원","userId":"05495556713808915653"},"user_tz":-540},"id":"5uhIDgL3Lgys","outputId":"988d0276-61f9-41e1-b66e-b272d5a784e7"},"outputs":[{"name":"stdout","output_type":"stream","text":["Train Dataset: <BatchDataset element_spec=(TensorSpec(shape=(8, 512, 512, 3), dtype=tf.float32, name=None), TensorSpec(shape=(8, 512, 512, 1), dtype=tf.float32, name=None))>\n","Validation Dataset: <BatchDataset element_spec=(TensorSpec(shape=(8, 512, 512, 3), dtype=tf.float32, name=None), TensorSpec(shape=(8, 512, 512, 1), dtype=tf.float32, name=None))>\n"]}],"source":["IMAGE_SIZE = 512\n","BATCH_SIZE = 8\n","NUM_CLASSES = 1\n","import tensorflow_addons as tfa\n","\n","def read_image(image_path, mask=False):\n","  image = tf.io.read_file(image_path)\n","  image = tf.image.decode_png(image, channels=3)\n","  image.set_shape([None, None, 3])\n","  image = tf.image.resize(images=image, size=[IMAGE_SIZE, IMAGE_SIZE])\n","  if not mask:\n","      image = image / 255\n","  return image\n","\n","def load_data(image_list, mask_list):\n","  image = read_image(image_list)\n","  mask = read_image(mask_list, mask=True)\n","  return image, mask\n","\n","def random_crop(input_image, real_image, size):\n","  stacked_image = tf.stack([input_image, real_image], axis=0)\n","  cropped_image = tf.image.random_crop(\n","      stacked_image, size=[2, size, size, 3])\n","  img,msk = cropped_image[0], cropped_image[1]\n","  return img,msk\n","\n","def augment(input_image, input_mask):\n","\n","  if tf.random.uniform(()) > 0.3:\n","      ratio = tf.random.uniform(shape=[],minval=400, maxval=440, dtype=tf.int32)\n","      input_image, input_mask = random_crop(input_image, input_mask, 412)\n","      input_image = tf.image.resize(input_image, (IMAGE_SIZE, IMAGE_SIZE))\n","      input_mask = tf.image.resize(input_mask, (IMAGE_SIZE, IMAGE_SIZE))\n","\n","  input_image = tf.image.random_brightness(input_image, 0.2)\n","\n","  saturation_factor = tf.random.uniform((),0,2)\n","  input_image = tf.image.adjust_saturation(input_image, saturation_factor)\n","\n","  if tf.random.uniform(()) > 0.5:\n","      input_image = tf.image.flip_left_right(input_image)\n","      input_mask = tf.image.flip_left_right(input_mask)\n","\n","  rot_factor = tf.cast(tf.random.uniform(shape=[],minval=-6, maxval=6, dtype=tf.int32), tf.float32)\n","  angle = np.pi/(12*6) *rot_factor\n","  input_image = tfa.image.rotate(input_image, angle)\n","  input_mask = tfa.image.rotate(input_mask, angle)\n","\n","  return input_image, input_mask\n","\n","def cast_mask(input_image, input_mask):\n","  input_mask = tf.math.reduce_sum(input_mask, axis=2)\n","  input_mask = input_mask[..., tf.newaxis]\n","  input_mask = tf.cast(input_mask>0, dtype=tf.float32)\n","  return input_image,input_mask\n","\n","def data_generator(image_list, mask_list, augument=True):\n","  dataset = tf.data.Dataset.from_tensor_slices((image_list, mask_list))\n","  dataset = dataset.map(load_data, num_parallel_calls=tf.data.AUTOTUNE)\n","  if augument:\n","    dataset = dataset.map(augment)\n","  dataset = dataset.map(cast_mask)\n","  dataset = dataset.batch(BATCH_SIZE, drop_remainder=True)\n","  return dataset\n","\n","train_dataset = data_generator(train_images, train_masks)\n","print(\"Train Dataset:\", train_dataset)\n","\n","val_dataset = data_generator(val_images, val_masks, augument=False)\n","print(\"Validation Dataset:\", val_dataset)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mscID--oLgyv"},"outputs":[],"source":["def convolution_block(\n","    block_input,\n","    num_filters=256,\n","    kernel_size=3,\n","    dilation_rate=1,\n","    padding=\"same\",\n","    use_bias=False,\n","):\n","    x = layers.Conv2D(\n","        num_filters,\n","        kernel_size=kernel_size,\n","        dilation_rate=dilation_rate,\n","        padding=\"same\",\n","        use_bias=use_bias,\n","        kernel_initializer=keras.initializers.HeNormal(),\n","    )(block_input)\n","    x = layers.BatchNormalization()(x)\n","    return tf.nn.relu(x)\n","\n","\n","def DilatedSpatialPyramidPooling(dspp_input):\n","    dims = dspp_input.shape\n","    x = layers.AveragePooling2D(pool_size=(dims[-3], dims[-2]))(dspp_input)\n","    x = convolution_block(x, kernel_size=1, use_bias=True)\n","    out_pool = layers.UpSampling2D(\n","        size=(dims[-3] // x.shape[1], dims[-2] // x.shape[2]), interpolation=\"bilinear\",\n","    )(x)\n","\n","    out_1 = convolution_block(dspp_input, kernel_size=1, dilation_rate=1)\n","    out_6 = convolution_block(dspp_input, kernel_size=3, dilation_rate=6)\n","    out_12 = convolution_block(dspp_input, kernel_size=3, dilation_rate=12)\n","    out_18 = convolution_block(dspp_input, kernel_size=3, dilation_rate=18)\n","\n","    x = layers.Concatenate(axis=-1)([out_pool, out_1, out_6, out_12, out_18])\n","    output = convolution_block(x, kernel_size=1)\n","    return output"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xLGVfa3bLgyz"},"outputs":[],"source":["def DeeplabV3Plus(image_size, num_classes):\n","    model_input = keras.Input(shape=(image_size, image_size, 3))\n","    effiucientnetV2M = keras.applications.EfficientNetV2M(\n","        weights=\"imagenet\", include_top=False, input_tensor=model_input\n","    )\n","    for layer in effiucientnetV2M.layers:\n","      if '_bn' not in layer.name:\n","        layer.trainable = False\n","    x = effiucientnetV2M.get_layer(\"block6a_expand_activation\").output\n","    x = DilatedSpatialPyramidPooling(x)\n","\n","    input_a = layers.UpSampling2D(\n","        size=(image_size // 4 // x.shape[1], image_size // 4 // x.shape[2]),\n","        interpolation=\"bilinear\",\n","    )(x)\n","    input_b = effiucientnetV2M.get_layer(\"block2e_add\").output\n","    input_b = convolution_block(input_b, num_filters=48, kernel_size=1)\n","\n","    x = layers.Concatenate(axis=-1)([input_a, input_b])\n","    x = convolution_block(x)\n","    x = convolution_block(x)\n","    x = layers.UpSampling2D(\n","        size=(image_size // x.shape[1], image_size // x.shape[2]),\n","        interpolation=\"bilinear\",\n","    )(x)\n","    model_output = layers.Conv2D(num_classes, kernel_size=(1, 1), padding=\"same\", activation='sigmoid')(x)\n","    return keras.Model(inputs=model_input, outputs=model_output)\n","\n","\n","model = DeeplabV3Plus(image_size=IMAGE_SIZE, num_classes=NUM_CLASSES)\n","# model.summary()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4576,"status":"ok","timestamp":1660377818139,"user":{"displayName":"이우원","userId":"05495556713808915653"},"user_tz":-540},"id":"5UJBWmlzJYEn","outputId":"598a450c-7069-4b89-bea2-d48635e26398"},"outputs":[{"name":"stdout","output_type":"stream","text":["Model: \"model_1\"\n","__________________________________________________________________________________________________\n"," Layer (type)                   Output Shape         Param #     Connected to                     \n","==================================================================================================\n"," input_2 (InputLayer)           [(None, 512, 512, 3  0           []                               \n","                                )]                                                                \n","                                                                                                  \n"," rescaling_1 (Rescaling)        (None, 512, 512, 3)  0           ['input_2[0][0]']                \n","                                                                                                  \n"," stem_conv (Conv2D)             (None, 256, 256, 24  648         ['rescaling_1[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," stem_bn (BatchNormalization)   (None, 256, 256, 24  96          ['stem_conv[0][0]']              \n","                                )                                                                 \n","                                                                                                  \n"," stem_activation (Activation)   (None, 256, 256, 24  0           ['stem_bn[0][0]']                \n","                                )                                                                 \n","                                                                                                  \n"," block1a_project_conv (Conv2D)  (None, 256, 256, 24  5184        ['stem_activation[0][0]']        \n","                                )                                                                 \n","                                                                                                  \n"," block1a_project_bn (BatchNorma  (None, 256, 256, 24  96         ['block1a_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block1a_project_activation (Ac  (None, 256, 256, 24  0          ['block1a_project_bn[0][0]']     \n"," tivation)                      )                                                                 \n","                                                                                                  \n"," block1a_add (Add)              (None, 256, 256, 24  0           ['block1a_project_activation[0][0\n","                                )                                ]',                              \n","                                                                  'stem_activation[0][0]']        \n","                                                                                                  \n"," block1b_project_conv (Conv2D)  (None, 256, 256, 24  5184        ['block1a_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block1b_project_bn (BatchNorma  (None, 256, 256, 24  96         ['block1b_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block1b_project_activation (Ac  (None, 256, 256, 24  0          ['block1b_project_bn[0][0]']     \n"," tivation)                      )                                                                 \n","                                                                                                  \n"," block1b_add (Add)              (None, 256, 256, 24  0           ['block1b_project_activation[0][0\n","                                )                                ]',                              \n","                                                                  'block1a_add[0][0]']            \n","                                                                                                  \n"," block1c_project_conv (Conv2D)  (None, 256, 256, 24  5184        ['block1b_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block1c_project_bn (BatchNorma  (None, 256, 256, 24  96         ['block1c_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block1c_project_activation (Ac  (None, 256, 256, 24  0          ['block1c_project_bn[0][0]']     \n"," tivation)                      )                                                                 \n","                                                                                                  \n"," block1c_add (Add)              (None, 256, 256, 24  0           ['block1c_project_activation[0][0\n","                                )                                ]',                              \n","                                                                  'block1b_add[0][0]']            \n","                                                                                                  \n"," block2a_expand_conv (Conv2D)   (None, 128, 128, 96  20736       ['block1c_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block2a_expand_bn (BatchNormal  (None, 128, 128, 96  384        ['block2a_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block2a_expand_activation (Act  (None, 128, 128, 96  0          ['block2a_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block2a_project_conv (Conv2D)  (None, 128, 128, 48  4608        ['block2a_expand_activation[0][0]\n","                                )                                ']                               \n","                                                                                                  \n"," block2a_project_bn (BatchNorma  (None, 128, 128, 48  192        ['block2a_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block2b_expand_conv (Conv2D)   (None, 128, 128, 19  82944       ['block2a_project_bn[0][0]']     \n","                                2)                                                                \n","                                                                                                  \n"," block2b_expand_bn (BatchNormal  (None, 128, 128, 19  768        ['block2b_expand_conv[0][0]']    \n"," ization)                       2)                                                                \n","                                                                                                  \n"," block2b_expand_activation (Act  (None, 128, 128, 19  0          ['block2b_expand_bn[0][0]']      \n"," ivation)                       2)                                                                \n","                                                                                                  \n"," block2b_project_conv (Conv2D)  (None, 128, 128, 48  9216        ['block2b_expand_activation[0][0]\n","                                )                                ']                               \n","                                                                                                  \n"," block2b_project_bn (BatchNorma  (None, 128, 128, 48  192        ['block2b_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block2b_add (Add)              (None, 128, 128, 48  0           ['block2b_project_bn[0][0]',     \n","                                )                                 'block2a_project_bn[0][0]']     \n","                                                                                                  \n"," block2c_expand_conv (Conv2D)   (None, 128, 128, 19  82944       ['block2b_add[0][0]']            \n","                                2)                                                                \n","                                                                                                  \n"," block2c_expand_bn (BatchNormal  (None, 128, 128, 19  768        ['block2c_expand_conv[0][0]']    \n"," ization)                       2)                                                                \n","                                                                                                  \n"," block2c_expand_activation (Act  (None, 128, 128, 19  0          ['block2c_expand_bn[0][0]']      \n"," ivation)                       2)                                                                \n","                                                                                                  \n"," block2c_project_conv (Conv2D)  (None, 128, 128, 48  9216        ['block2c_expand_activation[0][0]\n","                                )                                ']                               \n","                                                                                                  \n"," block2c_project_bn (BatchNorma  (None, 128, 128, 48  192        ['block2c_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block2c_add (Add)              (None, 128, 128, 48  0           ['block2c_project_bn[0][0]',     \n","                                )                                 'block2b_add[0][0]']            \n","                                                                                                  \n"," block2d_expand_conv (Conv2D)   (None, 128, 128, 19  82944       ['block2c_add[0][0]']            \n","                                2)                                                                \n","                                                                                                  \n"," block2d_expand_bn (BatchNormal  (None, 128, 128, 19  768        ['block2d_expand_conv[0][0]']    \n"," ization)                       2)                                                                \n","                                                                                                  \n"," block2d_expand_activation (Act  (None, 128, 128, 19  0          ['block2d_expand_bn[0][0]']      \n"," ivation)                       2)                                                                \n","                                                                                                  \n"," block2d_project_conv (Conv2D)  (None, 128, 128, 48  9216        ['block2d_expand_activation[0][0]\n","                                )                                ']                               \n","                                                                                                  \n"," block2d_project_bn (BatchNorma  (None, 128, 128, 48  192        ['block2d_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block2d_add (Add)              (None, 128, 128, 48  0           ['block2d_project_bn[0][0]',     \n","                                )                                 'block2c_add[0][0]']            \n","                                                                                                  \n"," block2e_expand_conv (Conv2D)   (None, 128, 128, 19  82944       ['block2d_add[0][0]']            \n","                                2)                                                                \n","                                                                                                  \n"," block2e_expand_bn (BatchNormal  (None, 128, 128, 19  768        ['block2e_expand_conv[0][0]']    \n"," ization)                       2)                                                                \n","                                                                                                  \n"," block2e_expand_activation (Act  (None, 128, 128, 19  0          ['block2e_expand_bn[0][0]']      \n"," ivation)                       2)                                                                \n","                                                                                                  \n"," block2e_project_conv (Conv2D)  (None, 128, 128, 48  9216        ['block2e_expand_activation[0][0]\n","                                )                                ']                               \n","                                                                                                  \n"," block2e_project_bn (BatchNorma  (None, 128, 128, 48  192        ['block2e_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block2e_add (Add)              (None, 128, 128, 48  0           ['block2e_project_bn[0][0]',     \n","                                )                                 'block2d_add[0][0]']            \n","                                                                                                  \n"," block3a_expand_conv (Conv2D)   (None, 64, 64, 192)  82944       ['block2e_add[0][0]']            \n","                                                                                                  \n"," block3a_expand_bn (BatchNormal  (None, 64, 64, 192)  768        ['block3a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3a_expand_activation (Act  (None, 64, 64, 192)  0          ['block3a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3a_project_conv (Conv2D)  (None, 64, 64, 80)   15360       ['block3a_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3a_project_bn (BatchNorma  (None, 64, 64, 80)  320         ['block3a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3b_expand_conv (Conv2D)   (None, 64, 64, 320)  230400      ['block3a_project_bn[0][0]']     \n","                                                                                                  \n"," block3b_expand_bn (BatchNormal  (None, 64, 64, 320)  1280       ['block3b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3b_expand_activation (Act  (None, 64, 64, 320)  0          ['block3b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3b_project_conv (Conv2D)  (None, 64, 64, 80)   25600       ['block3b_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3b_project_bn (BatchNorma  (None, 64, 64, 80)  320         ['block3b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3b_add (Add)              (None, 64, 64, 80)   0           ['block3b_project_bn[0][0]',     \n","                                                                  'block3a_project_bn[0][0]']     \n","                                                                                                  \n"," block3c_expand_conv (Conv2D)   (None, 64, 64, 320)  230400      ['block3b_add[0][0]']            \n","                                                                                                  \n"," block3c_expand_bn (BatchNormal  (None, 64, 64, 320)  1280       ['block3c_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3c_expand_activation (Act  (None, 64, 64, 320)  0          ['block3c_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3c_project_conv (Conv2D)  (None, 64, 64, 80)   25600       ['block3c_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3c_project_bn (BatchNorma  (None, 64, 64, 80)  320         ['block3c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3c_add (Add)              (None, 64, 64, 80)   0           ['block3c_project_bn[0][0]',     \n","                                                                  'block3b_add[0][0]']            \n","                                                                                                  \n"," block3d_expand_conv (Conv2D)   (None, 64, 64, 320)  230400      ['block3c_add[0][0]']            \n","                                                                                                  \n"," block3d_expand_bn (BatchNormal  (None, 64, 64, 320)  1280       ['block3d_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3d_expand_activation (Act  (None, 64, 64, 320)  0          ['block3d_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3d_project_conv (Conv2D)  (None, 64, 64, 80)   25600       ['block3d_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3d_project_bn (BatchNorma  (None, 64, 64, 80)  320         ['block3d_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3d_add (Add)              (None, 64, 64, 80)   0           ['block3d_project_bn[0][0]',     \n","                                                                  'block3c_add[0][0]']            \n","                                                                                                  \n"," block3e_expand_conv (Conv2D)   (None, 64, 64, 320)  230400      ['block3d_add[0][0]']            \n","                                                                                                  \n"," block3e_expand_bn (BatchNormal  (None, 64, 64, 320)  1280       ['block3e_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3e_expand_activation (Act  (None, 64, 64, 320)  0          ['block3e_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3e_project_conv (Conv2D)  (None, 64, 64, 80)   25600       ['block3e_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3e_project_bn (BatchNorma  (None, 64, 64, 80)  320         ['block3e_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3e_add (Add)              (None, 64, 64, 80)   0           ['block3e_project_bn[0][0]',     \n","                                                                  'block3d_add[0][0]']            \n","                                                                                                  \n"," block4a_expand_conv (Conv2D)   (None, 64, 64, 320)  25600       ['block3e_add[0][0]']            \n","                                                                                                  \n"," block4a_expand_bn (BatchNormal  (None, 64, 64, 320)  1280       ['block4a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4a_expand_activation (Act  (None, 64, 64, 320)  0          ['block4a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4a_dwconv2 (DepthwiseConv  (None, 32, 32, 320)  2880       ['block4a_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4a_bn (BatchNormalization  (None, 32, 32, 320)  1280       ['block4a_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4a_activation (Activation  (None, 32, 32, 320)  0          ['block4a_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4a_se_squeeze (GlobalAver  (None, 320)         0           ['block4a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4a_se_reshape (Reshape)   (None, 1, 1, 320)    0           ['block4a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4a_se_reduce (Conv2D)     (None, 1, 1, 20)     6420        ['block4a_se_reshape[0][0]']     \n","                                                                                                  \n"," block4a_se_expand (Conv2D)     (None, 1, 1, 320)    6720        ['block4a_se_reduce[0][0]']      \n","                                                                                                  \n"," block4a_se_excite (Multiply)   (None, 32, 32, 320)  0           ['block4a_activation[0][0]',     \n","                                                                  'block4a_se_expand[0][0]']      \n","                                                                                                  \n"," block4a_project_conv (Conv2D)  (None, 32, 32, 160)  51200       ['block4a_se_excite[0][0]']      \n","                                                                                                  \n"," block4a_project_bn (BatchNorma  (None, 32, 32, 160)  640        ['block4a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4b_expand_conv (Conv2D)   (None, 32, 32, 640)  102400      ['block4a_project_bn[0][0]']     \n","                                                                                                  \n"," block4b_expand_bn (BatchNormal  (None, 32, 32, 640)  2560       ['block4b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4b_expand_activation (Act  (None, 32, 32, 640)  0          ['block4b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4b_dwconv2 (DepthwiseConv  (None, 32, 32, 640)  5760       ['block4b_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4b_bn (BatchNormalization  (None, 32, 32, 640)  2560       ['block4b_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4b_activation (Activation  (None, 32, 32, 640)  0          ['block4b_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4b_se_squeeze (GlobalAver  (None, 640)         0           ['block4b_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4b_se_reshape (Reshape)   (None, 1, 1, 640)    0           ['block4b_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4b_se_reduce (Conv2D)     (None, 1, 1, 40)     25640       ['block4b_se_reshape[0][0]']     \n","                                                                                                  \n"," block4b_se_expand (Conv2D)     (None, 1, 1, 640)    26240       ['block4b_se_reduce[0][0]']      \n","                                                                                                  \n"," block4b_se_excite (Multiply)   (None, 32, 32, 640)  0           ['block4b_activation[0][0]',     \n","                                                                  'block4b_se_expand[0][0]']      \n","                                                                                                  \n"," block4b_project_conv (Conv2D)  (None, 32, 32, 160)  102400      ['block4b_se_excite[0][0]']      \n","                                                                                                  \n"," block4b_project_bn (BatchNorma  (None, 32, 32, 160)  640        ['block4b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4b_add (Add)              (None, 32, 32, 160)  0           ['block4b_project_bn[0][0]',     \n","                                                                  'block4a_project_bn[0][0]']     \n","                                                                                                  \n"," block4c_expand_conv (Conv2D)   (None, 32, 32, 640)  102400      ['block4b_add[0][0]']            \n","                                                                                                  \n"," block4c_expand_bn (BatchNormal  (None, 32, 32, 640)  2560       ['block4c_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4c_expand_activation (Act  (None, 32, 32, 640)  0          ['block4c_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4c_dwconv2 (DepthwiseConv  (None, 32, 32, 640)  5760       ['block4c_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4c_bn (BatchNormalization  (None, 32, 32, 640)  2560       ['block4c_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4c_activation (Activation  (None, 32, 32, 640)  0          ['block4c_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4c_se_squeeze (GlobalAver  (None, 640)         0           ['block4c_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4c_se_reshape (Reshape)   (None, 1, 1, 640)    0           ['block4c_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4c_se_reduce (Conv2D)     (None, 1, 1, 40)     25640       ['block4c_se_reshape[0][0]']     \n","                                                                                                  \n"," block4c_se_expand (Conv2D)     (None, 1, 1, 640)    26240       ['block4c_se_reduce[0][0]']      \n","                                                                                                  \n"," block4c_se_excite (Multiply)   (None, 32, 32, 640)  0           ['block4c_activation[0][0]',     \n","                                                                  'block4c_se_expand[0][0]']      \n","                                                                                                  \n"," block4c_project_conv (Conv2D)  (None, 32, 32, 160)  102400      ['block4c_se_excite[0][0]']      \n","                                                                                                  \n"," block4c_project_bn (BatchNorma  (None, 32, 32, 160)  640        ['block4c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4c_add (Add)              (None, 32, 32, 160)  0           ['block4c_project_bn[0][0]',     \n","                                                                  'block4b_add[0][0]']            \n","                                                                                                  \n"," block4d_expand_conv (Conv2D)   (None, 32, 32, 640)  102400      ['block4c_add[0][0]']            \n","                                                                                                  \n"," block4d_expand_bn (BatchNormal  (None, 32, 32, 640)  2560       ['block4d_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4d_expand_activation (Act  (None, 32, 32, 640)  0          ['block4d_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4d_dwconv2 (DepthwiseConv  (None, 32, 32, 640)  5760       ['block4d_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4d_bn (BatchNormalization  (None, 32, 32, 640)  2560       ['block4d_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4d_activation (Activation  (None, 32, 32, 640)  0          ['block4d_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4d_se_squeeze (GlobalAver  (None, 640)         0           ['block4d_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4d_se_reshape (Reshape)   (None, 1, 1, 640)    0           ['block4d_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4d_se_reduce (Conv2D)     (None, 1, 1, 40)     25640       ['block4d_se_reshape[0][0]']     \n","                                                                                                  \n"," block4d_se_expand (Conv2D)     (None, 1, 1, 640)    26240       ['block4d_se_reduce[0][0]']      \n","                                                                                                  \n"," block4d_se_excite (Multiply)   (None, 32, 32, 640)  0           ['block4d_activation[0][0]',     \n","                                                                  'block4d_se_expand[0][0]']      \n","                                                                                                  \n"," block4d_project_conv (Conv2D)  (None, 32, 32, 160)  102400      ['block4d_se_excite[0][0]']      \n","                                                                                                  \n"," block4d_project_bn (BatchNorma  (None, 32, 32, 160)  640        ['block4d_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4d_add (Add)              (None, 32, 32, 160)  0           ['block4d_project_bn[0][0]',     \n","                                                                  'block4c_add[0][0]']            \n","                                                                                                  \n"," block4e_expand_conv (Conv2D)   (None, 32, 32, 640)  102400      ['block4d_add[0][0]']            \n","                                                                                                  \n"," block4e_expand_bn (BatchNormal  (None, 32, 32, 640)  2560       ['block4e_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4e_expand_activation (Act  (None, 32, 32, 640)  0          ['block4e_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4e_dwconv2 (DepthwiseConv  (None, 32, 32, 640)  5760       ['block4e_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4e_bn (BatchNormalization  (None, 32, 32, 640)  2560       ['block4e_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4e_activation (Activation  (None, 32, 32, 640)  0          ['block4e_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4e_se_squeeze (GlobalAver  (None, 640)         0           ['block4e_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4e_se_reshape (Reshape)   (None, 1, 1, 640)    0           ['block4e_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4e_se_reduce (Conv2D)     (None, 1, 1, 40)     25640       ['block4e_se_reshape[0][0]']     \n","                                                                                                  \n"," block4e_se_expand (Conv2D)     (None, 1, 1, 640)    26240       ['block4e_se_reduce[0][0]']      \n","                                                                                                  \n"," block4e_se_excite (Multiply)   (None, 32, 32, 640)  0           ['block4e_activation[0][0]',     \n","                                                                  'block4e_se_expand[0][0]']      \n","                                                                                                  \n"," block4e_project_conv (Conv2D)  (None, 32, 32, 160)  102400      ['block4e_se_excite[0][0]']      \n","                                                                                                  \n"," block4e_project_bn (BatchNorma  (None, 32, 32, 160)  640        ['block4e_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4e_add (Add)              (None, 32, 32, 160)  0           ['block4e_project_bn[0][0]',     \n","                                                                  'block4d_add[0][0]']            \n","                                                                                                  \n"," block4f_expand_conv (Conv2D)   (None, 32, 32, 640)  102400      ['block4e_add[0][0]']            \n","                                                                                                  \n"," block4f_expand_bn (BatchNormal  (None, 32, 32, 640)  2560       ['block4f_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4f_expand_activation (Act  (None, 32, 32, 640)  0          ['block4f_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4f_dwconv2 (DepthwiseConv  (None, 32, 32, 640)  5760       ['block4f_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4f_bn (BatchNormalization  (None, 32, 32, 640)  2560       ['block4f_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4f_activation (Activation  (None, 32, 32, 640)  0          ['block4f_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4f_se_squeeze (GlobalAver  (None, 640)         0           ['block4f_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4f_se_reshape (Reshape)   (None, 1, 1, 640)    0           ['block4f_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4f_se_reduce (Conv2D)     (None, 1, 1, 40)     25640       ['block4f_se_reshape[0][0]']     \n","                                                                                                  \n"," block4f_se_expand (Conv2D)     (None, 1, 1, 640)    26240       ['block4f_se_reduce[0][0]']      \n","                                                                                                  \n"," block4f_se_excite (Multiply)   (None, 32, 32, 640)  0           ['block4f_activation[0][0]',     \n","                                                                  'block4f_se_expand[0][0]']      \n","                                                                                                  \n"," block4f_project_conv (Conv2D)  (None, 32, 32, 160)  102400      ['block4f_se_excite[0][0]']      \n","                                                                                                  \n"," block4f_project_bn (BatchNorma  (None, 32, 32, 160)  640        ['block4f_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4f_add (Add)              (None, 32, 32, 160)  0           ['block4f_project_bn[0][0]',     \n","                                                                  'block4e_add[0][0]']            \n","                                                                                                  \n"," block4g_expand_conv (Conv2D)   (None, 32, 32, 640)  102400      ['block4f_add[0][0]']            \n","                                                                                                  \n"," block4g_expand_bn (BatchNormal  (None, 32, 32, 640)  2560       ['block4g_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4g_expand_activation (Act  (None, 32, 32, 640)  0          ['block4g_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4g_dwconv2 (DepthwiseConv  (None, 32, 32, 640)  5760       ['block4g_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4g_bn (BatchNormalization  (None, 32, 32, 640)  2560       ['block4g_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4g_activation (Activation  (None, 32, 32, 640)  0          ['block4g_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4g_se_squeeze (GlobalAver  (None, 640)         0           ['block4g_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4g_se_reshape (Reshape)   (None, 1, 1, 640)    0           ['block4g_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4g_se_reduce (Conv2D)     (None, 1, 1, 40)     25640       ['block4g_se_reshape[0][0]']     \n","                                                                                                  \n"," block4g_se_expand (Conv2D)     (None, 1, 1, 640)    26240       ['block4g_se_reduce[0][0]']      \n","                                                                                                  \n"," block4g_se_excite (Multiply)   (None, 32, 32, 640)  0           ['block4g_activation[0][0]',     \n","                                                                  'block4g_se_expand[0][0]']      \n","                                                                                                  \n"," block4g_project_conv (Conv2D)  (None, 32, 32, 160)  102400      ['block4g_se_excite[0][0]']      \n","                                                                                                  \n"," block4g_project_bn (BatchNorma  (None, 32, 32, 160)  640        ['block4g_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4g_add (Add)              (None, 32, 32, 160)  0           ['block4g_project_bn[0][0]',     \n","                                                                  'block4f_add[0][0]']            \n","                                                                                                  \n"," block5a_expand_conv (Conv2D)   (None, 32, 32, 960)  153600      ['block4g_add[0][0]']            \n","                                                                                                  \n"," block5a_expand_bn (BatchNormal  (None, 32, 32, 960)  3840       ['block5a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block5a_expand_activation (Act  (None, 32, 32, 960)  0          ['block5a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block5a_dwconv2 (DepthwiseConv  (None, 32, 32, 960)  8640       ['block5a_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block5a_bn (BatchNormalization  (None, 32, 32, 960)  3840       ['block5a_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block5a_activation (Activation  (None, 32, 32, 960)  0          ['block5a_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block5a_se_squeeze (GlobalAver  (None, 960)         0           ['block5a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5a_se_reshape (Reshape)   (None, 1, 1, 960)    0           ['block5a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5a_se_reduce (Conv2D)     (None, 1, 1, 40)     38440       ['block5a_se_reshape[0][0]']     \n","                                                                                                  \n"," block5a_se_expand (Conv2D)     (None, 1, 1, 960)    39360       ['block5a_se_reduce[0][0]']      \n","                                                                                                  \n"," block5a_se_excite (Multiply)   (None, 32, 32, 960)  0           ['block5a_activation[0][0]',     \n","                                                                  'block5a_se_expand[0][0]']      \n","                                                                                                  \n"," block5a_project_conv (Conv2D)  (None, 32, 32, 176)  168960      ['block5a_se_excite[0][0]']      \n","                                                                                                  \n"," block5a_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5b_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5a_project_bn[0][0]']     \n","                                )                                                                 \n","                                                                                                  \n"," block5b_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5b_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5b_expand_activation (Act  (None, 32, 32, 1056  0          ['block5b_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5b_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5b_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5b_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5b_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5b_activation (Activation  (None, 32, 32, 1056  0          ['block5b_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5b_se_squeeze (GlobalAver  (None, 1056)        0           ['block5b_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5b_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5b_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5b_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5b_se_reshape[0][0]']     \n","                                                                                                  \n"," block5b_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5b_se_reduce[0][0]']      \n","                                                                                                  \n"," block5b_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5b_activation[0][0]',     \n","                                )                                 'block5b_se_expand[0][0]']      \n","                                                                                                  \n"," block5b_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5b_se_excite[0][0]']      \n","                                                                                                  \n"," block5b_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5b_add (Add)              (None, 32, 32, 176)  0           ['block5b_project_bn[0][0]',     \n","                                                                  'block5a_project_bn[0][0]']     \n","                                                                                                  \n"," block5c_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5b_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5c_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5c_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5c_expand_activation (Act  (None, 32, 32, 1056  0          ['block5c_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5c_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5c_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5c_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5c_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5c_activation (Activation  (None, 32, 32, 1056  0          ['block5c_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5c_se_squeeze (GlobalAver  (None, 1056)        0           ['block5c_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5c_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5c_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5c_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5c_se_reshape[0][0]']     \n","                                                                                                  \n"," block5c_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5c_se_reduce[0][0]']      \n","                                                                                                  \n"," block5c_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5c_activation[0][0]',     \n","                                )                                 'block5c_se_expand[0][0]']      \n","                                                                                                  \n"," block5c_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5c_se_excite[0][0]']      \n","                                                                                                  \n"," block5c_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5c_add (Add)              (None, 32, 32, 176)  0           ['block5c_project_bn[0][0]',     \n","                                                                  'block5b_add[0][0]']            \n","                                                                                                  \n"," block5d_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5c_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5d_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5d_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5d_expand_activation (Act  (None, 32, 32, 1056  0          ['block5d_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5d_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5d_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5d_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5d_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5d_activation (Activation  (None, 32, 32, 1056  0          ['block5d_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5d_se_squeeze (GlobalAver  (None, 1056)        0           ['block5d_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5d_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5d_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5d_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5d_se_reshape[0][0]']     \n","                                                                                                  \n"," block5d_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5d_se_reduce[0][0]']      \n","                                                                                                  \n"," block5d_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5d_activation[0][0]',     \n","                                )                                 'block5d_se_expand[0][0]']      \n","                                                                                                  \n"," block5d_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5d_se_excite[0][0]']      \n","                                                                                                  \n"," block5d_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5d_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5d_add (Add)              (None, 32, 32, 176)  0           ['block5d_project_bn[0][0]',     \n","                                                                  'block5c_add[0][0]']            \n","                                                                                                  \n"," block5e_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5d_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5e_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5e_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5e_expand_activation (Act  (None, 32, 32, 1056  0          ['block5e_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5e_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5e_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5e_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5e_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5e_activation (Activation  (None, 32, 32, 1056  0          ['block5e_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5e_se_squeeze (GlobalAver  (None, 1056)        0           ['block5e_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5e_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5e_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5e_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5e_se_reshape[0][0]']     \n","                                                                                                  \n"," block5e_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5e_se_reduce[0][0]']      \n","                                                                                                  \n"," block5e_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5e_activation[0][0]',     \n","                                )                                 'block5e_se_expand[0][0]']      \n","                                                                                                  \n"," block5e_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5e_se_excite[0][0]']      \n","                                                                                                  \n"," block5e_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5e_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5e_add (Add)              (None, 32, 32, 176)  0           ['block5e_project_bn[0][0]',     \n","                                                                  'block5d_add[0][0]']            \n","                                                                                                  \n"," block5f_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5e_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5f_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5f_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5f_expand_activation (Act  (None, 32, 32, 1056  0          ['block5f_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5f_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5f_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5f_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5f_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5f_activation (Activation  (None, 32, 32, 1056  0          ['block5f_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5f_se_squeeze (GlobalAver  (None, 1056)        0           ['block5f_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5f_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5f_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5f_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5f_se_reshape[0][0]']     \n","                                                                                                  \n"," block5f_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5f_se_reduce[0][0]']      \n","                                                                                                  \n"," block5f_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5f_activation[0][0]',     \n","                                )                                 'block5f_se_expand[0][0]']      \n","                                                                                                  \n"," block5f_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5f_se_excite[0][0]']      \n","                                                                                                  \n"," block5f_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5f_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5f_add (Add)              (None, 32, 32, 176)  0           ['block5f_project_bn[0][0]',     \n","                                                                  'block5e_add[0][0]']            \n","                                                                                                  \n"," block5g_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5f_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5g_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5g_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5g_expand_activation (Act  (None, 32, 32, 1056  0          ['block5g_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5g_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5g_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5g_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5g_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5g_activation (Activation  (None, 32, 32, 1056  0          ['block5g_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5g_se_squeeze (GlobalAver  (None, 1056)        0           ['block5g_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5g_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5g_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5g_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5g_se_reshape[0][0]']     \n","                                                                                                  \n"," block5g_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5g_se_reduce[0][0]']      \n","                                                                                                  \n"," block5g_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5g_activation[0][0]',     \n","                                )                                 'block5g_se_expand[0][0]']      \n","                                                                                                  \n"," block5g_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5g_se_excite[0][0]']      \n","                                                                                                  \n"," block5g_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5g_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5g_add (Add)              (None, 32, 32, 176)  0           ['block5g_project_bn[0][0]',     \n","                                                                  'block5f_add[0][0]']            \n","                                                                                                  \n"," block5h_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5g_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5h_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5h_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5h_expand_activation (Act  (None, 32, 32, 1056  0          ['block5h_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5h_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5h_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5h_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5h_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5h_activation (Activation  (None, 32, 32, 1056  0          ['block5h_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5h_se_squeeze (GlobalAver  (None, 1056)        0           ['block5h_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5h_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5h_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5h_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5h_se_reshape[0][0]']     \n","                                                                                                  \n"," block5h_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5h_se_reduce[0][0]']      \n","                                                                                                  \n"," block5h_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5h_activation[0][0]',     \n","                                )                                 'block5h_se_expand[0][0]']      \n","                                                                                                  \n"," block5h_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5h_se_excite[0][0]']      \n","                                                                                                  \n"," block5h_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5h_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5h_add (Add)              (None, 32, 32, 176)  0           ['block5h_project_bn[0][0]',     \n","                                                                  'block5g_add[0][0]']            \n","                                                                                                  \n"," block5i_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5h_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5i_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5i_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5i_expand_activation (Act  (None, 32, 32, 1056  0          ['block5i_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5i_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5i_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5i_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5i_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5i_activation (Activation  (None, 32, 32, 1056  0          ['block5i_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5i_se_squeeze (GlobalAver  (None, 1056)        0           ['block5i_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5i_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5i_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5i_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5i_se_reshape[0][0]']     \n","                                                                                                  \n"," block5i_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5i_se_reduce[0][0]']      \n","                                                                                                  \n"," block5i_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5i_activation[0][0]',     \n","                                )                                 'block5i_se_expand[0][0]']      \n","                                                                                                  \n"," block5i_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5i_se_excite[0][0]']      \n","                                                                                                  \n"," block5i_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5i_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5i_add (Add)              (None, 32, 32, 176)  0           ['block5i_project_bn[0][0]',     \n","                                                                  'block5h_add[0][0]']            \n","                                                                                                  \n"," block5j_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5i_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5j_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5j_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5j_expand_activation (Act  (None, 32, 32, 1056  0          ['block5j_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5j_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5j_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5j_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5j_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5j_activation (Activation  (None, 32, 32, 1056  0          ['block5j_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5j_se_squeeze (GlobalAver  (None, 1056)        0           ['block5j_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5j_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5j_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5j_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5j_se_reshape[0][0]']     \n","                                                                                                  \n"," block5j_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5j_se_reduce[0][0]']      \n","                                                                                                  \n"," block5j_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5j_activation[0][0]',     \n","                                )                                 'block5j_se_expand[0][0]']      \n","                                                                                                  \n"," block5j_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5j_se_excite[0][0]']      \n","                                                                                                  \n"," block5j_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5j_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5j_add (Add)              (None, 32, 32, 176)  0           ['block5j_project_bn[0][0]',     \n","                                                                  'block5i_add[0][0]']            \n","                                                                                                  \n"," block5k_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5j_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5k_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5k_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5k_expand_activation (Act  (None, 32, 32, 1056  0          ['block5k_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5k_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5k_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5k_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5k_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5k_activation (Activation  (None, 32, 32, 1056  0          ['block5k_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5k_se_squeeze (GlobalAver  (None, 1056)        0           ['block5k_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5k_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5k_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5k_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5k_se_reshape[0][0]']     \n","                                                                                                  \n"," block5k_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5k_se_reduce[0][0]']      \n","                                                                                                  \n"," block5k_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5k_activation[0][0]',     \n","                                )                                 'block5k_se_expand[0][0]']      \n","                                                                                                  \n"," block5k_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5k_se_excite[0][0]']      \n","                                                                                                  \n"," block5k_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5k_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5k_add (Add)              (None, 32, 32, 176)  0           ['block5k_project_bn[0][0]',     \n","                                                                  'block5j_add[0][0]']            \n","                                                                                                  \n"," block5l_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5k_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5l_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5l_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5l_expand_activation (Act  (None, 32, 32, 1056  0          ['block5l_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5l_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5l_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5l_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5l_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5l_activation (Activation  (None, 32, 32, 1056  0          ['block5l_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5l_se_squeeze (GlobalAver  (None, 1056)        0           ['block5l_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5l_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5l_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5l_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5l_se_reshape[0][0]']     \n","                                                                                                  \n"," block5l_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5l_se_reduce[0][0]']      \n","                                                                                                  \n"," block5l_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5l_activation[0][0]',     \n","                                )                                 'block5l_se_expand[0][0]']      \n","                                                                                                  \n"," block5l_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5l_se_excite[0][0]']      \n","                                                                                                  \n"," block5l_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5l_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5l_add (Add)              (None, 32, 32, 176)  0           ['block5l_project_bn[0][0]',     \n","                                                                  'block5k_add[0][0]']            \n","                                                                                                  \n"," block5m_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5l_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5m_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5m_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5m_expand_activation (Act  (None, 32, 32, 1056  0          ['block5m_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5m_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5m_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5m_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5m_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5m_activation (Activation  (None, 32, 32, 1056  0          ['block5m_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5m_se_squeeze (GlobalAver  (None, 1056)        0           ['block5m_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5m_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5m_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5m_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5m_se_reshape[0][0]']     \n","                                                                                                  \n"," block5m_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5m_se_reduce[0][0]']      \n","                                                                                                  \n"," block5m_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5m_activation[0][0]',     \n","                                )                                 'block5m_se_expand[0][0]']      \n","                                                                                                  \n"," block5m_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5m_se_excite[0][0]']      \n","                                                                                                  \n"," block5m_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5m_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5m_add (Add)              (None, 32, 32, 176)  0           ['block5m_project_bn[0][0]',     \n","                                                                  'block5l_add[0][0]']            \n","                                                                                                  \n"," block5n_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5m_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5n_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block5n_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5n_expand_activation (Act  (None, 32, 32, 1056  0          ['block5n_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5n_dwconv2 (DepthwiseConv  (None, 32, 32, 1056  9504       ['block5n_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5n_bn (BatchNormalization  (None, 32, 32, 1056  4224       ['block5n_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5n_activation (Activation  (None, 32, 32, 1056  0          ['block5n_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5n_se_squeeze (GlobalAver  (None, 1056)        0           ['block5n_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5n_se_reshape (Reshape)   (None, 1, 1, 1056)   0           ['block5n_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5n_se_reduce (Conv2D)     (None, 1, 1, 44)     46508       ['block5n_se_reshape[0][0]']     \n","                                                                                                  \n"," block5n_se_expand (Conv2D)     (None, 1, 1, 1056)   47520       ['block5n_se_reduce[0][0]']      \n","                                                                                                  \n"," block5n_se_excite (Multiply)   (None, 32, 32, 1056  0           ['block5n_activation[0][0]',     \n","                                )                                 'block5n_se_expand[0][0]']      \n","                                                                                                  \n"," block5n_project_conv (Conv2D)  (None, 32, 32, 176)  185856      ['block5n_se_excite[0][0]']      \n","                                                                                                  \n"," block5n_project_bn (BatchNorma  (None, 32, 32, 176)  704        ['block5n_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5n_add (Add)              (None, 32, 32, 176)  0           ['block5n_project_bn[0][0]',     \n","                                                                  'block5m_add[0][0]']            \n","                                                                                                  \n"," block6a_expand_conv (Conv2D)   (None, 32, 32, 1056  185856      ['block5n_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block6a_expand_bn (BatchNormal  (None, 32, 32, 1056  4224       ['block6a_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block6a_expand_activation (Act  (None, 32, 32, 1056  0          ['block6a_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," average_pooling2d_1 (AveragePo  (None, 1, 1, 1056)  0           ['block6a_expand_activation[0][0]\n"," oling2D)                                                        ']                               \n","                                                                                                  \n"," conv2d_10 (Conv2D)             (None, 1, 1, 256)    270592      ['average_pooling2d_1[0][0]']    \n","                                                                                                  \n"," batch_normalization_9 (BatchNo  (None, 1, 1, 256)   1024        ['conv2d_10[0][0]']              \n"," rmalization)                                                                                     \n","                                                                                                  \n"," conv2d_11 (Conv2D)             (None, 32, 32, 256)  270336      ['block6a_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," conv2d_12 (Conv2D)             (None, 32, 32, 256)  2433024     ['block6a_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," conv2d_13 (Conv2D)             (None, 32, 32, 256)  2433024     ['block6a_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," conv2d_14 (Conv2D)             (None, 32, 32, 256)  2433024     ['block6a_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," tf.nn.relu_9 (TFOpLambda)      (None, 1, 1, 256)    0           ['batch_normalization_9[0][0]']  \n","                                                                                                  \n"," batch_normalization_10 (BatchN  (None, 32, 32, 256)  1024       ['conv2d_11[0][0]']              \n"," ormalization)                                                                                    \n","                                                                                                  \n"," batch_normalization_11 (BatchN  (None, 32, 32, 256)  1024       ['conv2d_12[0][0]']              \n"," ormalization)                                                                                    \n","                                                                                                  \n"," batch_normalization_12 (BatchN  (None, 32, 32, 256)  1024       ['conv2d_13[0][0]']              \n"," ormalization)                                                                                    \n","                                                                                                  \n"," batch_normalization_13 (BatchN  (None, 32, 32, 256)  1024       ['conv2d_14[0][0]']              \n"," ormalization)                                                                                    \n","                                                                                                  \n"," up_sampling2d_3 (UpSampling2D)  (None, 32, 32, 256)  0          ['tf.nn.relu_9[0][0]']           \n","                                                                                                  \n"," tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['batch_normalization_10[0][0]'] \n","                                                                                                  \n"," tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 256)  0           ['batch_normalization_11[0][0]'] \n","                                                                                                  \n"," tf.nn.relu_12 (TFOpLambda)     (None, 32, 32, 256)  0           ['batch_normalization_12[0][0]'] \n","                                                                                                  \n"," tf.nn.relu_13 (TFOpLambda)     (None, 32, 32, 256)  0           ['batch_normalization_13[0][0]'] \n","                                                                                                  \n"," concatenate_2 (Concatenate)    (None, 32, 32, 1280  0           ['up_sampling2d_3[0][0]',        \n","                                )                                 'tf.nn.relu_10[0][0]',          \n","                                                                  'tf.nn.relu_11[0][0]',          \n","                                                                  'tf.nn.relu_12[0][0]',          \n","                                                                  'tf.nn.relu_13[0][0]']          \n","                                                                                                  \n"," conv2d_15 (Conv2D)             (None, 32, 32, 256)  327680      ['concatenate_2[0][0]']          \n","                                                                                                  \n"," batch_normalization_14 (BatchN  (None, 32, 32, 256)  1024       ['conv2d_15[0][0]']              \n"," ormalization)                                                                                    \n","                                                                                                  \n"," conv2d_16 (Conv2D)             (None, 128, 128, 48  2304        ['block2e_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," tf.nn.relu_14 (TFOpLambda)     (None, 32, 32, 256)  0           ['batch_normalization_14[0][0]'] \n","                                                                                                  \n"," batch_normalization_15 (BatchN  (None, 128, 128, 48  192        ['conv2d_16[0][0]']              \n"," ormalization)                  )                                                                 \n","                                                                                                  \n"," up_sampling2d_4 (UpSampling2D)  (None, 128, 128, 25  0          ['tf.nn.relu_14[0][0]']          \n","                                6)                                                                \n","                                                                                                  \n"," tf.nn.relu_15 (TFOpLambda)     (None, 128, 128, 48  0           ['batch_normalization_15[0][0]'] \n","                                )                                                                 \n","                                                                                                  \n"," concatenate_3 (Concatenate)    (None, 128, 128, 30  0           ['up_sampling2d_4[0][0]',        \n","                                4)                                'tf.nn.relu_15[0][0]']          \n","                                                                                                  \n"," conv2d_17 (Conv2D)             (None, 128, 128, 25  700416      ['concatenate_3[0][0]']          \n","                                6)                                                                \n","                                                                                                  \n"," batch_normalization_16 (BatchN  (None, 128, 128, 25  1024       ['conv2d_17[0][0]']              \n"," ormalization)                  6)                                                                \n","                                                                                                  \n"," tf.nn.relu_16 (TFOpLambda)     (None, 128, 128, 25  0           ['batch_normalization_16[0][0]'] \n","                                6)                                                                \n","                                                                                                  \n"," conv2d_18 (Conv2D)             (None, 128, 128, 25  589824      ['tf.nn.relu_16[0][0]']          \n","                                6)                                                                \n","                                                                                                  \n"," batch_normalization_17 (BatchN  (None, 128, 128, 25  1024       ['conv2d_18[0][0]']              \n"," ormalization)                  6)                                                                \n","                                                                                                  \n"," tf.nn.relu_17 (TFOpLambda)     (None, 128, 128, 25  0           ['batch_normalization_17[0][0]'] \n","                                6)                                                                \n","                                                                                                  \n"," up_sampling2d_5 (UpSampling2D)  (None, 512, 512, 25  0          ['tf.nn.relu_17[0][0]']          \n","                                6)                                                                \n","                                                                                                  \n"," conv2d_19 (Conv2D)             (None, 512, 512, 1)  257         ['up_sampling2d_5[0][0]']        \n","                                                                                                  \n","==================================================================================================\n","Total params: 19,623,473\n","Trainable params: 9,555,489\n","Non-trainable params: 10,067,984\n","__________________________________________________________________________________________________\n"]}],"source":["model.summary()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OBKIVmaU4ZFl"},"outputs":[],"source":["loss = keras.losses.BinaryCrossentropy()\n","model.compile(\n","    optimizer=keras.optimizers.Adam(learning_rate=0.01),\n","    loss=loss,\n","    metrics=[\"accuracy\",    \n","        tf.keras.metrics.BinaryIoU(),],\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BCW9gMU7HXjY"},"outputs":[],"source":["from keras import backend\n","from keras.utils import io_utils\n","from tensorflow.python.platform import tf_logging as logging\n","\n","class unfreeze_layers_reduce_lr(tf.keras.callbacks.ReduceLROnPlateau):\n","\n","  def __init__(self,\n","               monitor='val_loss',\n","               factor=0.1,\n","               patience=10,\n","               verbose=0,\n","               mode='auto',\n","               min_delta=1e-4,\n","               cooldown=0,\n","               min_lr=0,\n","               freezed=False,\n","               **kwargs):\n","      super().__init__(monitor, factor, patience, verbose, mode, min_delta, cooldown, min_lr)\n","      self.freezed = False\n","\n","  def on_epoch_end(self, epoch, logs=None):\n","    logs = logs or {}\n","    logs['lr'] = backend.get_value(self.model.optimizer.lr)\n","    current = logs.get(self.monitor)\n","    if current is None:\n","      logging.warning('Learning rate reduction is conditioned on metric `%s` '\n","                      'which is not available. Available metrics are: %s',\n","                      self.monitor, ','.join(list(logs.keys())))\n","    else:\n","      if self.in_cooldown():\n","        self.cooldown_counter -= 1\n","        self.wait = 0\n","\n","      if self.monitor_op(current, self.best):\n","        self.best = current\n","        self.wait = 0\n","\n","      elif not self.in_cooldown():\n","        self.wait += 1\n","        if self.wait >= self.patience:\n","          \n","          if not self.freezed:\n","            for layer in self.model.layers:\n","                      layer.trainable = True\n","            self.freezed=True\n","            old_lr = backend.get_value(self.model.optimizer.lr)\n","            new_lr = old_lr * 0.1\n","            backend.set_value(self.model.optimizer.lr, new_lr)\n","            io_utils.print_msg(\n","                    f'\\nEpoch {epoch +1}: '\n","                    f'Unfreezing backbone layers and reducing learning rate to {new_lr}')\n","            self.cooldown_counter = self.cooldown\n","            self.wait = 0\n","\n","          else:\n","            old_lr = backend.get_value(self.model.optimizer.lr)\n","            if old_lr > np.float32(self.min_lr):\n","              new_lr = old_lr * self.factor\n","              new_lr = max(new_lr, self.min_lr)\n","              backend.set_value(self.model.optimizer.lr, new_lr)\n","              if self.verbose > 0:\n","                io_utils.print_msg(\n","                    f'\\nEpoch {epoch +1}: '\n","                    f'ReduceLROnPlateau reducing learning rate to {new_lr}.')\n","              self.cooldown_counter = self.cooldown\n","              self.wait = 0\n","\n","model_path = f\"./model_weight/test_weight.h5\"\n","mcp = tf.keras.callbacks.ModelCheckpoint(model_path, monitor='val_loss', verbose=1, save_best_only=True)\n","rlr = unfreeze_layers_reduce_lr(monitor='val_loss', factor=0.5, patience=2, verbose=1, mode='min', min_delta=1e-4, cooldown=0, min_lr=0,)\n","es = tf.keras.callbacks.EarlyStopping(monitor='val_loss', patience=10)\n","\n","cb_list = [mcp, rlr, es]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GJoClIVd5Y9j","outputId":"9b9ca725-4e10-4556-ded3-fc077cbe5fee"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.1501 - accuracy: 0.9406 - mean_io_u_1: 0.2978\n","Epoch 1: val_loss improved from inf to 0.12077, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 5351s 928ms/step - loss: 0.1501 - accuracy: 0.9406 - mean_io_u_1: 0.2978 - val_loss: 0.1208 - val_accuracy: 0.9524 - val_mean_io_u_1: 0.3263 - lr: 0.0100\n","Epoch 2/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.1251 - accuracy: 0.9505 - mean_io_u_1: 0.2978\n","Epoch 2: val_loss improved from 0.12077 to 0.10536, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3417s 594ms/step - loss: 0.1251 - accuracy: 0.9505 - mean_io_u_1: 0.2978 - val_loss: 0.1054 - val_accuracy: 0.9579 - val_mean_io_u_1: 0.3263 - lr: 0.0100\n","Epoch 3/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.1171 - accuracy: 0.9536 - mean_io_u_1: 0.2974\n","Epoch 3: val_loss improved from 0.10536 to 0.10222, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3411s 593ms/step - loss: 0.1171 - accuracy: 0.9536 - mean_io_u_1: 0.2974 - val_loss: 0.1022 - val_accuracy: 0.9600 - val_mean_io_u_1: 0.3263 - lr: 0.0100\n","Epoch 4/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.1124 - accuracy: 0.9555 - mean_io_u_1: 0.2978\n","Epoch 4: val_loss did not improve from 0.10222\n","5748/5748 [==============================] - 3408s 593ms/step - loss: 0.1124 - accuracy: 0.9555 - mean_io_u_1: 0.2978 - val_loss: 0.1107 - val_accuracy: 0.9559 - val_mean_io_u_1: 0.3263 - lr: 0.0100\n","Epoch 5/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.1091 - accuracy: 0.9566 - mean_io_u_1: 0.2976\n","Epoch 5: val_loss did not improve from 0.10222\n","\n","Epoch 5: Unfreezing backbone layers and reducing learning rate to 0.0009999999776482583\n","5748/5748 [==============================] - 3408s 593ms/step - loss: 0.1091 - accuracy: 0.9566 - mean_io_u_1: 0.2976 - val_loss: 0.1072 - val_accuracy: 0.9573 - val_mean_io_u_1: 0.3263 - lr: 0.0100\n","Epoch 6/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0982 - accuracy: 0.9609 - mean_io_u_1: 0.2976\n","Epoch 6: val_loss improved from 0.10222 to 0.09056, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3411s 593ms/step - loss: 0.0982 - accuracy: 0.9609 - mean_io_u_1: 0.2976 - val_loss: 0.0906 - val_accuracy: 0.9641 - val_mean_io_u_1: 0.3263 - lr: 1.0000e-03\n","Epoch 7/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0947 - accuracy: 0.9623 - mean_io_u_1: 0.2977\n","Epoch 7: val_loss improved from 0.09056 to 0.08962, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3411s 593ms/step - loss: 0.0947 - accuracy: 0.9623 - mean_io_u_1: 0.2977 - val_loss: 0.0896 - val_accuracy: 0.9646 - val_mean_io_u_1: 0.3263 - lr: 1.0000e-03\n","Epoch 8/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0934 - accuracy: 0.9628 - mean_io_u_1: 0.2979\n","Epoch 8: val_loss improved from 0.08962 to 0.08866, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3411s 593ms/step - loss: 0.0934 - accuracy: 0.9628 - mean_io_u_1: 0.2979 - val_loss: 0.0887 - val_accuracy: 0.9649 - val_mean_io_u_1: 0.3263 - lr: 1.0000e-03\n","Epoch 9/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0927 - accuracy: 0.9630 - mean_io_u_1: 0.2974\n","Epoch 9: val_loss did not improve from 0.08866\n","5748/5748 [==============================] - 3407s 593ms/step - loss: 0.0927 - accuracy: 0.9630 - mean_io_u_1: 0.2974 - val_loss: 0.0889 - val_accuracy: 0.9649 - val_mean_io_u_1: 0.3263 - lr: 1.0000e-03\n","Epoch 10/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0918 - accuracy: 0.9634 - mean_io_u_1: 0.2977\n","Epoch 10: val_loss improved from 0.08866 to 0.08754, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3408s 593ms/step - loss: 0.0918 - accuracy: 0.9634 - mean_io_u_1: 0.2977 - val_loss: 0.0875 - val_accuracy: 0.9654 - val_mean_io_u_1: 0.3263 - lr: 1.0000e-03\n","Epoch 11/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0906 - accuracy: 0.9639 - mean_io_u_1: 0.2977\n","Epoch 11: val_loss did not improve from 0.08754\n","5748/5748 [==============================] - 3406s 592ms/step - loss: 0.0906 - accuracy: 0.9639 - mean_io_u_1: 0.2977 - val_loss: 0.0879 - val_accuracy: 0.9654 - val_mean_io_u_1: 0.3263 - lr: 1.0000e-03\n","Epoch 12/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0899 - accuracy: 0.9641 - mean_io_u_1: 0.2976\n","Epoch 12: val_loss improved from 0.08754 to 0.08728, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3409s 593ms/step - loss: 0.0899 - accuracy: 0.9641 - mean_io_u_1: 0.2976 - val_loss: 0.0873 - val_accuracy: 0.9655 - val_mean_io_u_1: 0.3263 - lr: 1.0000e-03\n","Epoch 13/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0892 - accuracy: 0.9644 - mean_io_u_1: 0.2976\n","Epoch 13: val_loss improved from 0.08728 to 0.08726, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3409s 593ms/step - loss: 0.0892 - accuracy: 0.9644 - mean_io_u_1: 0.2976 - val_loss: 0.0873 - val_accuracy: 0.9656 - val_mean_io_u_1: 0.3263 - lr: 1.0000e-03\n","Epoch 14/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0888 - accuracy: 0.9645 - mean_io_u_1: 0.2976\n","Epoch 14: val_loss did not improve from 0.08726\n","\n","Epoch 14: ReduceLROnPlateau reducing learning rate to 0.0004999999655410647.\n","5748/5748 [==============================] - 3406s 592ms/step - loss: 0.0888 - accuracy: 0.9645 - mean_io_u_1: 0.2976 - val_loss: 0.0875 - val_accuracy: 0.9655 - val_mean_io_u_1: 0.3263 - lr: 1.0000e-03\n","Epoch 15/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0873 - accuracy: 0.9651 - mean_io_u_1: 0.2977\n","Epoch 15: val_loss improved from 0.08726 to 0.08653, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3409s 593ms/step - loss: 0.0873 - accuracy: 0.9651 - mean_io_u_1: 0.2977 - val_loss: 0.0865 - val_accuracy: 0.9658 - val_mean_io_u_1: 0.3263 - lr: 5.0000e-04\n","Epoch 16/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0869 - accuracy: 0.9653 - mean_io_u_1: 0.2978\n","Epoch 16: val_loss improved from 0.08653 to 0.08648, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3410s 593ms/step - loss: 0.0869 - accuracy: 0.9653 - mean_io_u_1: 0.2978 - val_loss: 0.0865 - val_accuracy: 0.9658 - val_mean_io_u_1: 0.3263 - lr: 5.0000e-04\n","Epoch 17/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0867 - accuracy: 0.9654 - mean_io_u_1: 0.2975\n","Epoch 17: val_loss did not improve from 0.08648\n","\n","Epoch 17: ReduceLROnPlateau reducing learning rate to 0.00024999998277053237.\n","5748/5748 [==============================] - 3406s 593ms/step - loss: 0.0867 - accuracy: 0.9654 - mean_io_u_1: 0.2975 - val_loss: 0.0866 - val_accuracy: 0.9659 - val_mean_io_u_1: 0.3263 - lr: 5.0000e-04\n","Epoch 18/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0857 - accuracy: 0.9658 - mean_io_u_1: 0.2977\n","Epoch 18: val_loss improved from 0.08648 to 0.08618, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3409s 593ms/step - loss: 0.0857 - accuracy: 0.9658 - mean_io_u_1: 0.2977 - val_loss: 0.0862 - val_accuracy: 0.9660 - val_mean_io_u_1: 0.3263 - lr: 2.5000e-04\n","Epoch 19/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0857 - accuracy: 0.9658 - mean_io_u_1: 0.2977\n","Epoch 19: val_loss did not improve from 0.08618\n","5748/5748 [==============================] - 3406s 593ms/step - loss: 0.0857 - accuracy: 0.9658 - mean_io_u_1: 0.2977 - val_loss: 0.0863 - val_accuracy: 0.9660 - val_mean_io_u_1: 0.3263 - lr: 2.5000e-04\n","Epoch 20/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0853 - accuracy: 0.9660 - mean_io_u_1: 0.2973\n","Epoch 20: val_loss improved from 0.08618 to 0.08606, saving model to ./model_weight/test_weight.h5\n","5748/5748 [==============================] - 3409s 593ms/step - loss: 0.0853 - accuracy: 0.9660 - mean_io_u_1: 0.2973 - val_loss: 0.0861 - val_accuracy: 0.9660 - val_mean_io_u_1: 0.3263 - lr: 2.5000e-04\n","Epoch 21/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0851 - accuracy: 0.9661 - mean_io_u_1: 0.2974\n","Epoch 21: val_loss did not improve from 0.08606\n","5748/5748 [==============================] - 3408s 593ms/step - loss: 0.0851 - accuracy: 0.9661 - mean_io_u_1: 0.2974 - val_loss: 0.0863 - val_accuracy: 0.9660 - val_mean_io_u_1: 0.3263 - lr: 2.5000e-04\n","Epoch 22/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0848 - accuracy: 0.9661 - mean_io_u_1: 0.2977\n","Epoch 22: val_loss did not improve from 0.08606\n","\n","Epoch 22: ReduceLROnPlateau reducing learning rate to 0.00012499999138526618.\n","5748/5748 [==============================] - 3409s 593ms/step - loss: 0.0848 - accuracy: 0.9661 - mean_io_u_1: 0.2977 - val_loss: 0.0861 - val_accuracy: 0.9660 - val_mean_io_u_1: 0.3263 - lr: 2.5000e-04\n","Epoch 23/100\n","5748/5748 [==============================] - ETA: 0s - loss: 0.0846 - accuracy: 0.9662 - mean_io_u_1: 0.2976\n","Epoch 23: val_loss did not improve from 0.08606\n","5748/5748 [==============================] - 3409s 593ms/step - loss: 0.0846 - accuracy: 0.9662 - mean_io_u_1: 0.2976 - val_loss: 0.0861 - val_accuracy: 0.9661 - val_mean_io_u_1: 0.3263 - lr: 1.2500e-04\n","Epoch 24/100\n","4533/5748 [======================>.......] - ETA: 11:38 - loss: 0.0846 - accuracy: 0.9663 - mean_io_u_1: 0.2976"]}],"source":["history = model.fit(train_dataset, validation_data=val_dataset,\n","                    callbacks=cb_list, epochs=100)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UfpmC1UyvkCZ"},"outputs":[],"source":[""]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"machine_shape":"hm","name":"DLv3+_unfreeze","provenance":[{"file_id":"https://github.com/keras-team/keras-io/blob/master/examples/vision/ipynb/deeplabv3_plus.ipynb","timestamp":1659321316639}]},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.0"}},"nbformat":4,"nbformat_minor":0}